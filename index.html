<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="_csrf" content="${_csrf.token}"/>
	<!-- default header name is X-CSRF-TOKEN -->
	<meta name="_csrf_header" content="${_csrf.headerName}"/>
	<title>Payalto</title>
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
	
</head>
<body>
	<div class="container">
		<!-- Button trigger modal -->
		<button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal">Create Payment</button>

		<!-- Modal -->
		<div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
		  	<div class="modal-dialog" role="document">
		    	<div class="modal-content">
		      		<div class="modal-header">
		        		<h5 class="modal-title" id="exampleModalLabel">Create Payment</h5>
		        		<button type="button" class="close" data-dismiss="modal" aria-label="Close">
		          			<span aria-hidden="true">&times;</span>
		        		</button>
		      		</div>
			      	<div class="modal-body">
			      		<div class="form-group">
			      			<label class="text">Amount</label>
			        		<input class="form-control" type="decimal" name="amount" id="amount">
			      		</div>
			      		<div class="form-group">
			      			<label class="text">Currency</label>
			        		<input class="form-control" type="text" name="currency" id="currency">
			      		</div>
			      		<div class="form-group">
			      			<label class="text">Reference Id</label>
			        		<input class="form-control" type="text" name="reference_id" id="reference_id">
			      		</div>
			      		<div class="form-group">
			      			<label class="text">Success URL</label>
			        		<input class="form-control" type="text" name="success_url" id="success_url">
			      		</div>
			      		<div class="form-group">
			      			<label class="text">Fail URL</label>
			        		<input class="form-control" type="text" name="fail_url" id="fail_url">
			      		</div>
			      		<div class="form-group">
			      			<label class="text">Custom</label>
			        		<textarea class="form-control" name="custom" id="custom"></textarea>
			      		</div>

			      		
			      	</div>
			      	<div class="modal-footer">
			        	<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
			        	<button type="button" class="btn btn-primary" id="create-payment">Save</button>
			      	</div>
			    </div>
		  	</div>
		</div>

		<table class="table">
		<thead>
			<th>Payment ID</th>
			<th>Amount</th>
			<th>Status</th>
			<th>Customer (Array)</th>
			<th>Customer (JSON)</th>
			<th>Time</th>
			<th>Action</th>
		</thead>
		<tbody>
		</tbody>
		
	</table>
	</div>

	<script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.1.3/dist/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
	<script>
		$(document).ready(function(){
			$.get({
			    url : 'http://payalto.s3.stuffio.com/api/v1/payments',
			    type: 'GET',
			    datatype: 'json',
			    beforeSend: function(xhr) {
			    	xhr.setRequestHeader ("Authorization", "Basic " + btoa('payalto:pass_authorize'));
			    	xhr.setRequestHeader("Access-Control-Allow-Origin", "*");
			    },
			    success : function(data) {
			    	for (var i = 0; i < data.data.length; i++) {
			    		// result = '<tr>';
			    		// result += '<td>'+data.data[i].+'</td>';
			    		// result += '<td></td>';
			    		// result += '<td></td>';
			    		// result += '<td></td>';
			    		// result += '<td></td>';
			    		// result += '<td></td>';
			    		// result += '<td></td>';
			    		// result += '</tr>';
			    		// $('tbody').append('')
			    	}
			    	
			        console.log(data);
			    },
			    error : function(request,error)
			    {
			        console.log(request);
			    }
			});

			$('#create-payment').click(function() {
				let amount = $('#amount').val();
				let currency = $('#currency').val();
				let reference_id = $('#reference_id').val();
				let success_url = $('#success_url').val();
				let fail_url = $('#fail_url').val();
				let custom = $('#custom').val();
				$.ajax({
				    url : 'http://payalto.s3.stuffio.com/api/v1/payments',
				    type : 'POST',
				    datatype: 'jsonp',
				    data: {
				    	p_key: 'payalto_6789',
				    	amount: amount,
				    	currency: currency,
				    	reference_id: reference_id,
				    	success_url: success_url,
				    	fail_url: fail_url,
				    	custom: custom,

				    },
				    beforeSend: function(xhr){
				    	xhr.setRequestHeader ("Authorization", "Basic " + btoa('payalto:pass_authorize'));
				    },
				    success : function(data) {
			    		// result = '<tr>';
			    		// result += '<td>'+data.data[i].+'</td>';
			    		// result += '<td></td>';
			    		// result += '<td></td>';
			    		// result += '<td></td>';
			    		// result += '<td></td>';
			    		// result += '<td></td>';
			    		// result += '</tr>';
			    		// $('tbody').append('')
				    	
				        console.log('Data: '+data);
				    },
				    error : function(request,error)
				    {
				        console.log('Error: '+request);
				    }
				});
			})
		});
		
	</script>
</body>
</html>